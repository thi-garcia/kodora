#!/usr/bin/env bash
# PATH: .husky/pre-commit
set -euo pipefail

echo "ğŸ” Running pre-commit checks..."

# Detecta ambiente e escolhe pnpm certo
PNPM_CMD="pnpm"
UNAME="$(uname -s | tr '[:upper:]' '[:lower:]')"
if [[ "${OS:-}" == "Windows_NT" || "$UNAME" == *"mingw"* || "$UNAME" == *"msys"* ]]; then
  PNPM_CMD="pnpm.cmd"
fi

echo "ğŸ–Šï¸  Prettier check..."
$PNPM_CMD -s format:check || {
  echo "âŒ Prettier encontrou diferenÃ§as. Rode: pnpm format"
  exit 1
}

echo "ğŸ§¹ ESLint..."
$PNPM_CMD -s lint || {
  echo "âŒ Lint falhou. Dica: pnpm lint:fix"
  exit 1
}

echo "âœ… pre-commit OK"
